!function(a,b){if("function"==typeof define&&define.amd)define(["exports"],b);else if("undefined"!=typeof exports)b(exports);else{var c={exports:{}};b(c.exports),a.actual=c.exports}}(this,function(a){"use strict";const b="undefined",c="object",d="function",e=typeof self==c&&self.self===self&&self||typeof global==c&&global.global===global&&global||this,f=e?e.safe:void 0,g=Object.keys,h=Array.isArray,i=Infinity,j=Object.prototype.hasOwnProperty,k="Callback was already called.",l=["Array or Object are required","Array is required","Exactly two arguments are required","Function is required"],m=(a)=>{if(null===a)return!1;const b=typeof a;return b==c||b==d},n=(a)=>typeof a==b,o=(a)=>typeof a==d,p=(a)=>a&&o(a.then),q=(a)=>{if(a)return a.data},r=(a)=>a&&a.constructor&&"AsyncFunction"===a.constructor.name,s=(a,b)=>{const c=new TypeError(a);if(!o(b)||b===U)throw c;b(c)},t=(a)=>{let b=-1;return{next:()=>(b++,b<a.length?{value:a[b],key:b,done:!1}:{done:!0})}},u=(a)=>{let b=-1;const c=a[Symbol.iterator]();return{next:()=>{b++;const a=c.next();return a.done?{done:!0}:{value:a.value,key:b,done:!1}}}},v=(a)=>{const b=g(a),c=b.length;let d=-1;return{next:()=>{d++;const e=b[d];return d<c?{value:a[e],key:e,done:!1}:{done:!0}}}},w=(a)=>h(a)?t(a):a[typeof Symbol==d&&Symbol.iterator]?u(a):v(a),x=(a,b)=>{a.then((a)=>{S(b,null,a)},(a)=>{S(b,a)})},y=(a,b,c,d)=>{let e=0,f=!1,g=w(a),h=!1;const i=A(d),j=()=>{if(!(f||h))for(;e<b&&!1==h;){let a=g.next();if(a.done){f=!0,0>=e&&i();break}e++,c(a.value,a.key,(a)=>{e--,a?(h=!0,i(a)):!1==f&&e<b?j():f&&0>=e&&i()})}};j()},z=(a)=>(b)=>b(null,a()),A=(a)=>{let b=!1;return(...c)=>{if(!(b||null==a))return b=!0,a(...c)}},B=(a)=>{let b=!1;return(...c)=>{if(b)throw new Error(k);return b=!0,a(...c)}},C=(a,b,c,d)=>{if(!m(a))return s(l[0],d);const e=[];let f=0;y(a,b,(a,b,d)=>{const g=f++;X((b)=>c(a,b),(a,b)=>{e[g]=b,d(a)})},(a)=>{d(a,e)})},D=(a,b,c,d)=>{if(!m(a))return s(l[0],d);const e={};y(a,b,(a,b,d)=>{X((d)=>c(a,b,d),(a,c)=>{e[b]=c,d(a)})},(a)=>{d(a,e)})},E=(a,b,c,d)=>m(a)?void C(a,b,(a,b)=>{X((b)=>c(a,b),(c,d)=>c?b(c):void b(c,{key:d,val:a}))},(a,b)=>{const c={};b.forEach((a)=>{j.call(c,a.key)?c[a.key].push(a.val):c[a.key]=[a.val]}),d(a,c)}):s(l[0],d),F=(a,b,c,d,e)=>{if(!h(b))return s(l[1],e);const f=[];y(b,c,(b,c,e)=>{X((a)=>d(b,a),(d,g)=>{(a&&g||!(a||g))&&f.push({data:b,i:c}),e(d)})},(a)=>{e(a,f.sort((c,a)=>c.i-a.i).map(q))})},G=(a,b,c,d,e)=>{let f=a;y(b,c,(b,c,e)=>{X((a)=>d(b,a),(b)=>{a?(!b&&(f=!1),e(!b)):(b&&(f=!0),e(f))})},()=>e(f))},H=(a,b,c)=>{const d=h(a)?[]:{};y(a,b,(a,b,c)=>{X(a,(a,...e)=>{d[b]=e.length?1===e.length?e[0]:e:null,c(a)})},(a)=>{c(a,d)})},I=(a,b,c,d)=>{const e=parseInt(a),f=Array(e);for(let g=0;g<e;g++)f[g]=g;C(f,b,c,d)},J=(a,b,c,d)=>{let e;y(a,b,(a,b,d)=>{X((b)=>c(a,b),(b)=>{b&&(e=a),d(e||null)})},()=>d(e))},K=(a,b,c,d)=>h(a)?void C(a,b,c,(a,b)=>{d(a,[].concat(...b))}):s(l[1],d),L=(a,b,c,d,e)=>{const f=()=>{X(b,Z(e,g))},g=(b)=>{X(a,Z(e,(a)=>{a==c?e(null,b):f()}))};d?g():f()},M=(a,b,c,d=U,e)=>{if(!h(a))return s(l[1],d);const f=w(a),g=a.length,i=(b,h)=>{if(b)return void d(b);const j=f.next();j.done?d(null,h):X((b)=>c(h,e?j.value:a[g-1-j.key],b),i)};i(null,b)},N=(a)=>function(b,...c){const d=function(...c){const d=c.pop();y(b,a,(a,b,d)=>{X((b)=>a.apply(this,c.concat(b)),d)},d)};return 0===c.length?d:d.apply(this,c)};class O{constructor(a,b,c){const d=parseInt(b);if(!d)throw new TypeError("Concurrency must not be zero");Object.defineProperties(this,{name:{enumerable:!0,configurable:!1,writable:!1,value:c},__worker:{enumerable:!1,configurable:!1,writable:!1,value:a},__workers:{enumerable:!1,configurable:!1,writable:!0,value:0},__workersList:{enumerable:!1,configurable:!1,writable:!0,value:[]},__isProcessing:{enumerable:!1,configurable:!1,writable:!0,value:!1},__processingScheduled:{enumerable:!1,configurable:!1,writable:!0,value:!1},tasks:{enumerable:!1,configurable:!1,writable:!1,value:[]},concurrency:{enumerable:!0,configurable:!1,writable:!0,value:d},buffer:{enumerable:!0,configurable:!1,writable:!0,value:d/4},started:{enumerable:!0,configurable:!1,writable:!0,value:!1},paused:{enumerable:!0,configurable:!1,writable:!0,value:!1}})}__insert(a,b,c){if(null!=c&&!o(c))throw new TypeError(l[3]);this.started=!0;const d=h(a)?a:[a];if(0===d.length&&this.idle())return S(()=>{this.drain()});const e=d.map((a)=>({data:a,callback:B(c||U)}));b?this.tasks.unshift(...e):this.tasks.push(...e),this.__processingScheduled||(this.__processingScheduled=!0,S(()=>{this.__processingScheduled=!1,this.__execute()}))}__execute(){if(!this.__isProcessing){for(this.__isProcessing=!0;!this.paused&&this.__workers<this.concurrency&&this.tasks.length;){let a=this.tasks.shift();this.__workersList.push(a),0===this.tasks.length&&this.empty();let b=a.data;this.__workers++,this.__workers===this.concurrency&&this.saturated(),X((a)=>this.__worker(b,a),(...c)=>{this.__workers--;const d=this.__workersList.indexOf(a);0===d?this.__workersList.shift():0<d&&this.__workersList.splice(d,1),a.callback(...c),c[0]&&this.error(c[0],b),this.__workers<=this.concurrency-this.buffer&&this.unsaturated(),this.idle()&&this.drain(),this.__execute()})}this.__isProcessing=!1}}remove(a){let b=this.tasks.filter((b)=>!a(b.data));this.tasks.length=b.length,b.forEach((a,b)=>{this.tasks[b]=a})}push(a,b){this.__insert(a,!1,b)}saturated(){}unsaturated(){}empty(){}drain(){}error(){}kill(){delete this.drain,this.tasks.length=0}length(){return this.tasks.length}running(){return this.__workers}idle(){return 0===this.tasks.length+this.__workers}pause(){this.paused=!0}resume(){this.paused&&(this.paused=!1,S(()=>this.__execute()))}workersList(){return this.__workersList}}class P extends O{constructor(a,b){super(a,b,"Priority Queue")}push(a,b,c){this.__insert(a,b||0,c)}__insert(a,b,c){if(null!=c&&!o(c))throw new TypeError(l[3]);this.started=!0;const d=h(a)?a:[a];if(0===d.length&&this.idle())return S(()=>{this.drain()});const e=d.map((a)=>({data:a,priority:b,callback:B(c||U)}));let f=this.tasks.length,g=f?this.tasks[0].priority:0,i=f?this.tasks[f-1].priority:0;b>g?this.tasks.unshift(...e):this.tasks.push(...e),g>=b&&b<i&&this.tasks.sort((c,b)=>b.priority-c.priority),this.__processingScheduled||(this.__processingScheduled=!0,S(()=>{this.__processingScheduled=!1,this.__execute()}))}}class Q extends O{constructor(a,b){super(a,b,"Queue")}unshift(a,b){this.__insert(a,!0,b)}}class R extends O{constructor(a,b){super(a,1,"Cargo");const c=parseInt(b);if(!c)throw new TypeError("Payload must not be zero");Object.defineProperties(this,{payload:{enumerable:!0,configurable:!1,writable:!0,value:c}})}__execute(){if(!this.__isProcessing){for(this.__isProcessing=!0;!this.paused&&this.__workers<this.concurrency&&this.tasks.length;){let a=this.tasks.splice(0,this.payload);this.__workersList.push(...a),0===this.tasks.length&&this.empty();let b=a.map(q);this.__workers++,this.__workers===this.concurrency&&this.saturated(),X((a)=>this.__worker(b,a),(...b)=>{this.__workers--,a.forEach((a)=>{const c=this.__workersList.indexOf(a);0===c?this.__workersList.shift():0<c&&this.__workersList.splice(c,1),a.callback(...b)}),this.__workers<=this.concurrency-this.buffer&&this.unsaturated(),this.idle()&&this.drain(),this.__execute()})}this.__isProcessing=!1}}}const S=(()=>typeof setImmediate==b?typeof process==b?typeof Image==d?(a,...b)=>{if(!o(a))throw new TypeError(l[3]);const c=new Image;c.onerror=()=>{a(...b)},c.src="data:image/png,0"}:(a,...b)=>{if(!o(a))throw new TypeError(l[3]);setTimeout(a,0,...b)}:(a,...b)=>{if(!o(a))throw new TypeError(l[3]);process.nextTick(()=>{a(...b)})}:(...a)=>{if(!o(a[0]))throw new TypeError(l[3]);setImmediate(...a)})(),T=typeof process!=b&&process.nextTick?process.nextTick:S,U=()=>{},V=(a)=>function(...b){let c=!0;const d=b[b.length-1];b[b.length-1]=function(...a){c?S(()=>d.apply(this,a)):d.apply(this,a)};const e=a.apply(this,b);return c=!1,e},W=(a)=>function(...b){const c=b.pop();X((c)=>{const d=a.apply(this,b);return r(a)||p(d)?d:c(null,d)},c)},X=(a,b)=>{if(r(a))return void x(a(),b);let c,d,e=!1;const f=(...a)=>{if(e)throw a[0]||new Error(c||k);e=!0,b(...a)};try{d=a(f)}catch(a){if(!a)throw a;S(f,a)}if(p(d)){if(c="Resolution method is overspecified. Call a callback *or* return a Promise.",e)throw new Error(c);x(d,f)}},Y=(a,b)=>{if(!o(b)||!o(a))throw new TypeError(l[2]);return function(c,...d){if(c)return void a(c);let e;try{e=b.apply(this,d)}catch(b){if(!b)throw b;return void S(a,b)}n(e)?S(a,null):S(a,null,e)}},Z=(a,b)=>{if(n(b)||!o(a))throw new TypeError(l[2]);return function(c,...d){if(c)a(c);else if(!o(b))S(a,null,b);else try{return b.apply(this,d)}catch(b){if(!b)throw b;S(a,b)}}},$=(a,b,c,d=U)=>{M(a,b,c,d,1)},_=(a,b,c,d=U)=>{M(a,b,c,d,0)},aa=(a,b,c=U)=>h(a)?void y(a,i,(a,c,d)=>{X((c)=>b(a,c),d)},c):s(l[1],c),ba=(a,b,c,d=U)=>h(a)?void y(a,b,(a,b,d)=>{X((b)=>c(a,b),d)},d):s(l[1],d),ca=(a,b,c=U)=>h(a)?void y(a,1,(a,c,d)=>{X((c)=>b(a,c),d)},c):s(l[1],c),da=(a,b,c=U)=>m(a,c)?void y(a,i,(a,c,d)=>{X((d)=>b(a,c,d),d)},c):s(l[0],c),ea=(a,b,c,d=U)=>m(a)?void y(a,b,(a,b,d)=>{X((d)=>c(a,b,d),d)},d):s(l[0],d),fa=(a,b,c=U)=>m(a)?void y(a,1,(a,c,d)=>{X((d)=>b(a,c,d),d)},c):s(l[0],c),ga=(a,b,c=U)=>{F(!0,a,i,b,c)},ha=(a,b,c,d=U)=>{F(!0,a,b,c,d)},ia=(a,b,c=U)=>{F(!0,a,1,b,c)},ja=(a,b,c=U)=>{G(!1,a,i,b,c)},ka=(a,b,c,d=U)=>{G(!1,a,b,c,d)},la=(a,b,c=U)=>{G(!1,a,1,b,c)},ma=(a,b,c=U)=>{G(!0,a,i,b,c)},na=(a,b,c,d=U)=>{G(!0,a,b,c,d)},oa=(a,b,c=U)=>{G(!0,a,1,b,c)},pa=function(a,b,c){if(1>arguments.length||3<arguments.length)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");let d,e,f,g=0,h=()=>g;o(a)?(c=b,b=a,e=5):m(a)?(e=parseInt(a.times)||5,o(a.interval)?h=a.interval:g=parseInt(a.interval)||g,a.errorFilter&&(f=a.errorFilter)):e=parseInt(e)||5;const i=(a,g)=>{let i=g;y(Array(e),1,(a,c,g)=>{X((a)=>b(a,i),(a,b)=>{if(d=a||null,i={err:d,result:b},!(a&&c<e-1))g(!a);else if(f&&!f(a))g(!0);else{let a=h(c+1);0<a?setTimeout(g,a):g()}})},()=>{(a||c||U)(d,i)})};return c?i():i},qa=(a)=>function(...b){const c=b[b.length-1];b[b.length-1]=(a,...b)=>{if(a)c(null,{error:a});else{let a;a=b.length?1===b.length?b[0]:b:null,c(null,{value:a})}};const d=a.apply(this,b);(r(a)||p(d))&&d.then((a)=>{S(c,null,{value:a})},(a)=>{S(c,null,{error:a})})},ra=N(i),sa=N(1);a["default"]={noConflict:()=>(e.safe=f,this),noop:U,nextTick:T,back:S,setImmediate:S,yield:S,apply:(a,...b)=>(...c)=>a(...b,...c),async:(a,b,...c)=>(d)=>{try{return a[b].apply(a,c.concat(d))}catch(a){if(!a)throw a;S(d,a)}},inherits:(a,b)=>{a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1}})},args:function(...a){const b=a.length,c=parseInt(this);if(c!==c)throw new Error("Pass arguments to \"safe.args\" only through \".apply\" method!");if(0===b||c>b)return[];const d=Array(b-c);for(let e=c;e<b;e++)d[e-c]=0>e?null:a[e];return d},ensureAsync:V,constant:(...a)=>(b)=>b(null,...a),result:(a,b)=>{if(!o(b)||!o(a))throw new TypeError(l[2]);return function(...c){let d;try{d=b.apply(this,c)}catch(b){if(!b)throw b;return void a(b)}n(d)?S(a,null):S(a,null,d)}},sure_result:Y,trap_sure_result:Y,sure:Z,trap_sure:Z,sure_spread:(a,b)=>{if(n(b)||!o(a))throw new TypeError(l[2]);return function(c,...d){if(c)return void a(c);try{return b.apply(this,d[0])}catch(b){if(!b)throw b;S(a,b)}}},spread:(a)=>function(b){return a.apply(this,b)},trap:(a,b)=>{if(n(a))throw new TypeError(l[2]);return function(...c){n(b)&&(b=a,a=c[c.length-1]);try{return b.apply(this,c)}catch(b){if(!b)throw b;S(a,b)}}},wrap:(a,b)=>{if(!o(a)||!o(b))throw new TypeError(l[2]);return function(...c){c.push(b);try{return a.apply(this,c)}catch(a){if(!a)throw a;S(b,a)}}},run:X,each:aa,forEach:aa,eachLimit:ba,forEachLimit:ba,eachSeries:ca,forEachSeries:ca,eachOf:da,forEachOf:da,eachOfLimit:ea,forEachOfLimit:ea,eachOfSeries:fa,forEachOfSeries:fa,map:(a,b,c=U)=>{C(a,i,b,c)},mapLimit:(a,b,c,d=U)=>{C(a,b,c,d)},mapSeries:(a,b,c=U)=>{C(a,1,b,c)},groupBy:(a,b,c=U)=>{E(a,i,b,c)},groupByLimit:(a,b,c,d=U)=>{E(a,b,c,d)},groupBySeries:(a,b,c=U)=>{E(a,1,b,c)},mapValues:(a,b,c=U)=>{D(a,i,b,c)},mapValuesLimit:(a,b,c,d=U)=>{D(a,b,c,d)},mapValuesSeries:(a,b,c=U)=>{D(a,1,b,c)},concat:(a,b,c=U)=>{K(a,i,b,c)},concatLimit:(a,b,c,d=U)=>{K(a,b,c,d)},concatSeries:(a,b,c=U)=>{K(a,1,b,c)},sortBy:(a,b,c=U)=>{if(!h(a))return s(l[1],c);const d=[];y(a,i,(a,c,e)=>{X((c)=>b(a,c),(b,f)=>{d[c]={data:a,i:f},e(b)})},(a)=>{c(a,d.sort((c,a)=>c.i-a.i).map(q))})},filter:ga,select:ga,filterLimit:ha,selectLimit:ha,filterSeries:ia,selectSeries:ia,reject:(a,b,c=U)=>{F(!1,a,i,b,c)},rejectLimit:(a,b,c,d=U)=>{F(!1,a,b,c,d)},rejectSeries:(a,b,c=U)=>{F(!1,a,1,b,c)},waterfall:(a,b=U)=>{if(!h(a))return s(l[1],b);const c=w(a),d=(a,...e)=>{if(a)return void b(a);const f=c.next();f.done?b(null,...e):X((a)=>f.value(...e,a),d)};d()},series:(a,b=U)=>{H(a,1,b)},parallel:(a,b=U)=>{H(a,i,b)},parallelLimit:(a,b,c=U)=>{H(a,b,c)},auto:(a,b,c)=>{const d={},e=Object.create(null),f=g(a);let l,m=f.length,n=0,k=null;if(o(b)&&(c=b,b=i),f.forEach((b)=>{if(!k){const c=a[b];if(h(c)){let d=c.slice(0,c.length-1);for(let e,f=0;f<d.length;f++){if(e=j.call(a,c[f])?a[c[f]]:null,!e){k=new Error(`safe.auto task \`${b}\` has a non-existent dependency \`${c[f]}\` in ${d.join(", ")}`);break}if(e===b||h(e)&&-1!==e.indexOf(b)){k=new Error(`safe.auto cannot execute tasks due to a recursive dependency`);break}}}}}),k){if(o(c))return c(k);throw new Error(k)}const p=A(c),q=()=>{f.forEach((c)=>{if(l||n>=b||e[c])return;let f;const g=a[c];if(h(g)){let a=g.length-1;for(let b=0;b<a;b++)if(!j.call(d,g[b]))return;f=g[a]}else f=g;e[c]=!0,n++,X((a)=>f(a,d),(a,...b)=>{m--,n--,l||(l=a||0===m,a?p(a,d):(d[c]=b.length?1===b.length?b[0]:b:null,l?p(a,d):q()))})})};q()},whilst:(a,b,c=U)=>{L(z(a),b,!1,!0,c)},doWhilst:(a,b,c=U)=>{L(z(b),a,!1,!1,c)},during:(a,b,c=U)=>{L(a,b,!1,!0,c)},doDuring:(a,b,c=U)=>{L(b,a,!1,!1,c)},until:(a,b,c=U)=>{L(z(a),b,!0,!0,c)},doUntil:(a,b,c=U)=>{L(z(b),a,!0,!1,c)},forever:(a,b=U)=>{const c=B(b),d=V(a),e=()=>{d(Z(c,e))};e()},reduce:$,inject:$,foldl:$,reduceRight:_,foldr:_,queue:(a,b)=>new Q(a,b),priorityQueue:(a,b)=>new P(a,b),cargo:(a,b)=>new R(a,b),retry:pa,retryable:pa,times:(a,b,c)=>{I(a,i,b,c)},timesLimit:(a,b,c,d)=>{I(a,b,c,d)},timesSeries:(a,b,c)=>{I(a,1,b,c)},detect:(a,b,c)=>{J(a,i,b,c)},detectLimit:(a,b,c,d)=>{J(a,b,c,d)},detectSeries:(a,b,c)=>{J(a,1,b,c)},some:ja,any:ja,someLimit:ka,anyLimit:ka,someSeries:la,anySeries:la,every:ma,all:ma,everyLimit:na,allLimit:na,everySeries:oa,allSeries:oa,applyEach:ra,applyEachSeries:sa,asyncify:W,wrapSync:W,memoize:(a,b=(a)=>a)=>{const c={},d={},e=(...e)=>{const f=e.pop(),g=b(...e);j.call(c,g)?S(()=>f(...c[g])):j.call(d,g)?d[g].push(f):(d[g]=[f],a(...e,(...a)=>{c[g]=a;const b=d[g];delete d[g],b.forEach((b)=>{b(...a)})}))};return e.memo=c,e.unmemoized=a,e},unmemoize:(a)=>(...b)=>(a.unmemoized||a)(...b),transform:function(a,b,c,d){3>=arguments.length&&(d=c,c=b,b=h(a)?[]:{}),d=A(d),y(a,i,(a,d,e)=>{X((e)=>c(b,a,d,e),e)},(a)=>d(a,b))},reflect:qa,reflectAll:(a)=>{if(h(a))return a.map(qa);let b={};return g(a).forEach((c)=>{b[c]=qa(a[c])}),b},race:(a,b)=>{if(!h(a))return s(l[0],b);if(!a.length)b();else{const c=A(b);a.forEach((a)=>{a(c)})}},tryEach:(a,b=U)=>{if(!m(a,b))return s(l[0],b);let c,d=null;y(a,1,(a,b,e)=>{X(a,(a,...b)=>{c=1>=b.length?b[0]:b,d=a,e(!a)})},()=>{b(d,c)})}},Object.keys(a["default"]).forEach((b)=>{a[b]=a["default"][b]}),Object.defineProperty(a,"__esModule",{value:!0})});
