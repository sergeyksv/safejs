!function(a,b){if("function"==typeof define&&define.amd)define(["exports"],b);else if("undefined"!=typeof exports)b(exports);else{var c={exports:{}};b(c.exports),a.actual=c.exports}}(this,function(a){"use strict";const b="undefined",c="object",d="function",e=typeof self==c&&self.self===self&&self||typeof global==c&&global.global===global&&global||this,f=e?e.safe:void 0,g=typeof Symbol==d&&Symbol.iterator,h=Object.keys,j=Array.isArray,i=Infinity,k=Object.prototype.hasOwnProperty,l="Callback was already called.",m=["Array or Object are required","Array is required","Exactly two arguments are required","Function is required"],n=(a)=>{if(null===a)return!1;const b=typeof a;return b==c||b==d},o=(a)=>typeof a==b,q=(a)=>typeof a==d,p=(a)=>a&&q(a.then),r=(a)=>{if(a)return a.data},s=(a)=>"AsyncFunction"===a.constructor.name,t=(a,b)=>{const c=new TypeError(a);if(!q(b)||b===W)throw c;b(c)},u=(a)=>{let b=-1;return{next:()=>(b++,b<a.length?{value:a[b],key:b,done:!1}:{done:!0})}},v=(a)=>{let b=-1;const c=a[g]();return{next:()=>{b++;const a=c.next();return a.done?{done:!0}:{value:a.value,key:b,done:!1}}}},w=(a)=>{const b=h(a),c=b.length;let d=-1;return{next:()=>{d++;const e=b[d];return d<c?{value:a[e],key:e,done:!1}:{done:!0}}}},x=(a)=>j(a)?u(a):g&&a[g]?v(a):w(a),y=(a,b)=>{a.then((a)=>{U(b,null,a)},(a)=>{U(b,a)})},z=(a,b,c,d)=>{let e=0,f=!1,g=x(a),h=!1;const i=C(d),j=()=>{if(!(f||h))for(;e<b&&!1==h;){let a=g.next();if(a.done){f=!0,0>=e&&i();break}e++,c(a.value,a.key,(a)=>{e--,a?(h=!0,i(a)):!1==f&&e<b?j():f&&0>=e&&i()})}};j()},A=(a,b)=>{if(s(a))return void y(a(),b);let c;try{c=a(b)}catch(a){if(!a)throw a;return void b(a)}p(c)&&y(c,b)},B=(a)=>(b)=>b(null,a()),C=(a)=>{let b=!1;return(...c)=>{if(!(b||null==a))return b=!0,a(...c)}},D=(a)=>{let b=!1;return(...c)=>{if(b)throw new Error(l);return b=!0,a(...c)}},E=(a,b,c,d)=>{if(!n(a))return t(m[0],d);const e=[];let f=0;z(a,b,(a,b,d)=>{const g=f++;Z((b)=>c(a,b),(a,b)=>{e[g]=b,d(a)})},(a)=>{d(a,e)})},F=(a,b,c,d)=>{if(!n(a))return t(m[0],d);const e={};z(a,b,(a,b,d)=>{Z((d)=>c(a,b,d),(a,c)=>{e[b]=c,d(a)})},(a)=>{d(a,e)})},G=(a,b,c,d)=>n(a)?void E(a,b,(a,b)=>{Z((b)=>c(a,b),(c,d)=>c?b(c):void b(c,{key:d,val:a}))},(a,b)=>{const c={};b.forEach((a)=>{k.call(c,a.key)?c[a.key].push(a.val):c[a.key]=[a.val]}),d(a,c)}):t(m[0],d),H=(a,b,c,d,e)=>{if(!j(b))return t(m[1],e);const f=[];z(b,c,(b,c,e)=>{Z((a)=>d(b,a),(d,g)=>{(a&&g||!(a||g))&&f.push({data:b,i:c}),e(d)})},(a)=>{e(a,f.sort((c,a)=>c.i-a.i).map(r))})},I=(a,b,c,d,e)=>{let f=a;z(b,c,(b,c,e)=>{Z((a)=>d(b,a),(b)=>{a?(!b&&(f=!1),e(!b)):(b&&(f=!0),e(f))})},()=>e(f))},J=(a,b,c)=>{const d=j(a)?[]:{};z(a,b,(a,b,c)=>{Z(a,(a,...e)=>{d[b]=e.length?1===e.length?e[0]:e:null,c(a)})},(a)=>{c(a,d)})},K=(a,b,c,d)=>{const e=parseInt(a),f=Array(e);for(let g=0;g<e;g++)f[g]=g;E(f,b,c,d)},L=(a,b,c,d)=>{let e;z(a,b,(a,b,d)=>{Z((b)=>c(a,b),(b)=>{b&&(e=a),d(e||null)})},()=>d(e))},M=(a,b,c,d)=>j(a)?void E(a,b,c,(a,b)=>{d(a,[].concat(...b))}):t(m[1],d),N=(a,b,c,d,e)=>{const f=()=>{Z(b,_(e,g))},g=(b)=>{Z(a,_(e,(a)=>{a==c?e(null,b):f()}))};d?g():f()},O=(a,b,c,d=W,e)=>{if(!j(a))return t(m[1],d);const f=x(a),g=a.length,h=(b,i)=>{if(b)return void d(b);const j=f.next();j.done?d(null,i):Z((b)=>c(i,e?j.value:a[g-1-j.key],b),h)};h(null,b)},P=(a)=>function(b,...c){const d=function(...c){const d=c.pop();z(b,a,(a,b,d)=>{Z((b)=>a.apply(this,c.concat(b)),d)},d)};return 0===c.length?d:d.apply(this,c)};class Q{constructor(a,b,c){const d=parseInt(b);if(!d)throw new TypeError("Concurrency must not be zero");Object.defineProperties(this,{name:{enumerable:!0,configurable:!1,writable:!1,value:c},__worker:{enumerable:!1,configurable:!1,writable:!1,value:a},__workers:{enumerable:!1,configurable:!1,writable:!0,value:0},__workersList:{enumerable:!1,configurable:!1,writable:!0,value:[]},__isProcessing:{enumerable:!1,configurable:!1,writable:!0,value:!1},__processingScheduled:{enumerable:!1,configurable:!1,writable:!0,value:!1},tasks:{enumerable:!1,configurable:!1,writable:!1,value:[]},concurrency:{enumerable:!0,configurable:!1,writable:!0,value:d},buffer:{enumerable:!0,configurable:!1,writable:!0,value:d/4},started:{enumerable:!0,configurable:!1,writable:!0,value:!1},paused:{enumerable:!0,configurable:!1,writable:!0,value:!1}})}__insert(a,b,c){if(null!=c&&!q(c))throw new TypeError(m[3]);this.started=!0;const d=j(a)?a:[a];if(0===d.length&&this.idle())return U(()=>{this.drain()});const e=d.map((a)=>({data:a,callback:D(c||W)}));b?this.tasks.unshift(...e):this.tasks.push(...e),this.__processingScheduled||(this.__processingScheduled=!0,U(()=>{this.__processingScheduled=!1,this.__execute()}))}__execute(){if(!this.__isProcessing){for(this.__isProcessing=!0;!this.paused&&this.__workers<this.concurrency&&this.tasks.length;){let a=this.tasks.shift();this.__workersList.push(a),0===this.tasks.length&&this.empty();let b=a.data;this.__workers++,this.__workers===this.concurrency&&this.saturated(),Z((c)=>this.__worker.call(a,b,c),(...c)=>{this.__workers--;const d=this.__workersList.indexOf(a);0===d?this.__workersList.shift():0<d&&this.__workersList.splice(d,1),a.callback(...c),c[0]&&this.error(c[0],b),this.__workers<=this.concurrency-this.buffer&&this.unsaturated(),this.idle()&&this.drain(),this.__execute()})}this.__isProcessing=!1}}remove(a){let b=this.tasks.filter((b)=>!a(b.data));this.tasks.length=b.length,b.forEach((a,b)=>{this.tasks[b]=a})}push(a,b){this.__insert(a,!1,b)}saturated(){}unsaturated(){}empty(){}drain(){}error(){}kill(){delete this.drain,this.tasks.length=0}length(){return this.tasks.length}running(){return this.__workers}idle(){return 0===this.tasks.length+this.__workers}pause(){this.paused=!0}resume(){this.paused&&(this.paused=!1,U(()=>this.__execute()))}workersList(){return this.__workersList}}class R extends Q{constructor(a,b){super(a,b,"Priority Queue")}push(a,b,c){this.__insert(a,b||0,c)}__insert(a,b,c){if(null!=c&&!q(c))throw new TypeError(m[3]);this.started=!0;const d=j(a)?a:[a];if(0===d.length&&this.idle())return U(()=>{this.drain()});const e=d.map((a)=>({data:a,priority:b,callback:D(c||W)}));let f=this.tasks.length,g=f?this.tasks[0].priority:0,h=f?this.tasks[f-1].priority:0;b>g?this.tasks.unshift(...e):this.tasks.push(...e),g>=b&&b<h&&this.tasks.sort((c,b)=>b.priority-c.priority),this.__processingScheduled||(this.__processingScheduled=!0,U(()=>{this.__processingScheduled=!1,this.__execute()}))}}class S extends Q{constructor(a,b){super(a,b,"Queue")}unshift(a,b){this.__insert(a,!0,b)}}class T extends Q{constructor(a,b){super(a,1,"Cargo");const c=parseInt(b);if(!c)throw new TypeError("Payload must not be zero");Object.defineProperties(this,{payload:{enumerable:!0,configurable:!1,writable:!0,value:c}})}__execute(){if(!this.__isProcessing){for(this.__isProcessing=!0;!this.paused&&this.__workers<this.concurrency&&this.tasks.length;){let a=this.tasks.splice(0,this.payload);this.__workersList.push(...a),0===this.tasks.length&&this.empty();let b=a.map(r);this.__workers++,this.__workers===this.concurrency&&this.saturated(),Z((a)=>this.__worker.call(null,b,a),(...b)=>{this.__workers--,a.forEach((a)=>{const c=this.__workersList.indexOf(a);0===c?this.__workersList.shift():0<c&&this.__workersList.splice(c,1),a.callback(...b)}),this.__workers<=this.concurrency-this.buffer&&this.unsaturated(),this.idle()&&this.drain(),this.__execute()})}this.__isProcessing=!1}}}const U=(()=>typeof setImmediate==b?typeof process==b?typeof Image==d?(a,...b)=>{if(!q(a))throw new TypeError(m[3]);const c=new Image;c.onerror=()=>{a(...b)},c.src="data:image/png,0"}:(a,...b)=>{if(!q(a))throw new TypeError(m[3]);setTimeout(a,0,...b)}:(a,...b)=>{if(!q(a))throw new TypeError(m[3]);process.nextTick(()=>{a(...b)})}:(...a)=>{if(!q(a[0]))throw new TypeError(m[3]);setImmediate(...a)})(),V=typeof process!=b&&process.nextTick?process.nextTick:U,W=()=>{},X=(a)=>function(...b){let c=!0;const d=b[b.length-1];b[b.length-1]=function(...a){c?U(()=>d.apply(this,a)):d.apply(this,a)};const e=a.apply(this,b);return c=!1,e},Y=(a)=>function(...b){const c=b.pop();A((c)=>{const d=a.apply(this,b);return s(a)||p(d)?d:c(null,d)},c)},Z=(a,b)=>{if(s(a))return void y(a(),b);let c,d,e=!1;const f=(...a)=>{if(e)throw a[0]||new Error(c||l);e=!0,b(...a)};try{d=a(f)}catch(a){if(!a)throw a;U(f,a)}if(p(d)){if(c="Resolution method is overspecified. Call a callback *or* return a Promise.",e)throw new Error(c);y(d,f)}},$=(a,b)=>{if(!q(b)||!q(a))throw new TypeError(m[2]);return function(c,...d){if(c)return void a(c);let e;try{e=b.apply(this,d)}catch(b){if(!b)throw b;return void U(a,b)}o(e)?U(a,null):U(a,null,e)}},_=(a,b)=>{if(o(b)||!q(a))throw new TypeError(m[2]);return function(c,...d){if(c)a(c);else if(!q(b))U(a,null,b);else try{return b.apply(this,d)}catch(b){if(!b)throw b;U(a,b)}}},aa=(a,b,c,d=W)=>{O(a,b,c,d,1)},ba=(a,b,c,d=W)=>{O(a,b,c,d,0)},ca=(a,b,c=W)=>j(a)?void z(a,i,(a,c,d)=>{Z((c)=>b(a,c),d)},c):t(m[1],c),da=(a,b,c,d=W)=>j(a)?void z(a,b,(a,b,d)=>{Z((b)=>c(a,b),d)},d):t(m[1],d),ea=(a,b,c=W)=>j(a)?void z(a,1,(a,c,d)=>{Z((c)=>b(a,c),d)},c):t(m[1],c),fa=(a,b,c=W)=>n(a,c)?void z(a,i,(a,c,d)=>{Z((d)=>b(a,c,d),d)},c):t(m[0],c),ga=(a,b,c,d=W)=>n(a)?void z(a,b,(a,b,d)=>{Z((d)=>c(a,b,d),d)},d):t(m[0],d),ha=(a,b,c=W)=>n(a)?void z(a,1,(a,c,d)=>{Z((d)=>b(a,c,d),d)},c):t(m[0],c),ia=(a,b,c=W)=>{H(!0,a,i,b,c)},ja=(a,b,c,d=W)=>{H(!0,a,b,c,d)},ka=(a,b,c=W)=>{H(!0,a,1,b,c)},la=(a,b,c=W)=>{I(!1,a,i,b,c)},ma=(a,b,c,d=W)=>{I(!1,a,b,c,d)},na=(a,b,c=W)=>{I(!1,a,1,b,c)},oa=(a,b,c=W)=>{I(!0,a,i,b,c)},pa=(a,b,c,d=W)=>{I(!0,a,b,c,d)},qa=(a,b,c=W)=>{I(!0,a,1,b,c)},ra=function(a,b,c){if(1>arguments.length||3<arguments.length)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");let d,e,f,g=0,h=()=>g;q(a)?(c=b,b=a,e=5):n(a)?(e=parseInt(a.times)||5,q(a.interval)?h=a.interval:g=parseInt(a.interval)||g,a.errorFilter&&(f=a.errorFilter)):e=parseInt(e)||5;const i=(a,g)=>{let i=g;z(Array(e),1,(a,c,g)=>{Z((a)=>b(a,i),(a,b)=>{if(d=a||null,i={err:d,result:b},!(a&&c<e-1))g(!a);else if(f&&!f(a))g(!0);else{let a=h(c+1);0<a?setTimeout(g,a):g()}})},()=>{(a||c||W)(d,i)})};return c?i():i},sa=(a)=>function(...b){const c=b[b.length-1];b[b.length-1]=(a,...b)=>{if(a)c(null,{error:a});else{let a;a=b.length?1===b.length?b[0]:b:null,c(null,{value:a})}};const d=a.apply(this,b);(s(a)||p(d))&&d.then((a)=>{U(c,null,{value:a})},(a)=>{U(c,null,{error:a})})},ta=P(i),ua=P(1);a["default"]={noConflict:()=>(e.safe=f,this),noop:W,nextTick:V,back:U,setImmediate:U,yield:U,apply:(a,...b)=>(...c)=>a(...b,...c),async:(a,b,...c)=>(d)=>{try{return a[b].apply(a,c.concat(d))}catch(a){if(!a)throw a;U(d,a)}},inherits:(a,b)=>{a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1}})},args:function(...a){const b=a.length,c=parseInt(this);if(c!==c)throw new Error("Pass arguments to \"safe.args\" only through \".apply\" method!");if(0===b||c>b)return[];const d=Array(b-c);for(let e=c;e<b;e++)d[e-c]=0>e?null:a[e];return d},ensureAsync:X,constant:(...a)=>(b)=>b(null,...a),result:(a,b)=>{if(!q(b)||!q(a))throw new TypeError(m[2]);return function(...c){let d;try{d=b.apply(this,c)}catch(b){if(!b)throw b;return void a(b)}o(d)?U(a,null):U(a,null,d)}},sure_result:$,trap_sure_result:$,sure:_,trap_sure:_,sure_spread:(a,b)=>{if(o(b)||!q(a))throw new TypeError(m[2]);return function(c,...d){if(c)return void a(c);try{return b.apply(this,d[0])}catch(b){if(!b)throw b;U(a,b)}}},spread:(a)=>function(b){return a.apply(this,b)},trap:(a,b)=>{if(o(a))throw new TypeError(m[2]);return function(...c){o(b)&&(b=a,a=c[c.length-1]);try{return b.apply(this,c)}catch(b){if(!b)throw b;U(a,b)}}},wrap:(a,b)=>{if(!q(a)||!q(b))throw new TypeError(m[2]);return function(...c){c.push(b);try{return a.apply(this,c)}catch(a){if(!a)throw a;U(b,a)}}},run:Z,each:ca,forEach:ca,eachLimit:da,forEachLimit:da,eachSeries:ea,forEachSeries:ea,eachOf:fa,forEachOf:fa,eachOfLimit:ga,forEachOfLimit:ga,eachOfSeries:ha,forEachOfSeries:ha,map:(a,b,c=W)=>{E(a,i,b,c)},mapLimit:(a,b,c,d=W)=>{E(a,b,c,d)},mapSeries:(a,b,c=W)=>{E(a,1,b,c)},groupBy:(a,b,c=W)=>{G(a,i,b,c)},groupByLimit:(a,b,c,d=W)=>{G(a,b,c,d)},groupBySeries:(a,b,c=W)=>{G(a,1,b,c)},mapValues:(a,b,c=W)=>{F(a,i,b,c)},mapValuesLimit:(a,b,c,d=W)=>{F(a,b,c,d)},mapValuesSeries:(a,b,c=W)=>{F(a,1,b,c)},concat:(a,b,c=W)=>{M(a,i,b,c)},concatLimit:(a,b,c,d=W)=>{M(a,b,c,d)},concatSeries:(a,b,c=W)=>{M(a,1,b,c)},sortBy:(a,b,c=W)=>{if(!j(a))return t(m[1],c);const d=[];z(a,i,(a,c,e)=>{Z((c)=>b(a,c),(b,f)=>{d[c]={data:a,i:f},e(b)})},(a)=>{c(a,d.sort((c,a)=>c.i-a.i).map(r))})},filter:ia,select:ia,filterLimit:ja,selectLimit:ja,filterSeries:ka,selectSeries:ka,reject:(a,b,c=W)=>{H(!1,a,i,b,c)},rejectLimit:(a,b,c,d=W)=>{H(!1,a,b,c,d)},rejectSeries:(a,b,c=W)=>{H(!1,a,1,b,c)},waterfall:(a,b=W)=>{if(!j(a))return t(m[1],b);const c=x(a),d=(a,...e)=>{if(a)return void b(a);const f=c.next();f.done?b(null,...e):Z((a)=>f.value(...e,a),d)};d()},series:(a,b=W)=>{J(a,1,b)},parallel:(a,b=W)=>{J(a,i,b)},parallelLimit:(a,b,c=W)=>{J(a,b,c)},auto:(a,b,c)=>{const d={},e=Object.create(null),f=h(a);let g,l=f.length,m=0,n=null;if(q(b)&&(c=b,b=i),f.forEach((b)=>{if(!n){const c=a[b];if(j(c)){let d=c.slice(0,c.length-1);for(let e,f=0;f<d.length;f++){if(e=k.call(a,c[f])?a[c[f]]:null,!e){n=new Error(`safe.auto task \`${b}\` has a non-existent dependency \`${c[f]}\` in ${d.join(", ")}`);break}if(e===b||j(e)&&-1!==e.indexOf(b)){n=new Error(`safe.auto cannot execute tasks due to a recursive dependency`);break}}}}}),n){if(q(c))return c(n);throw new Error(n)}const o=C(c),p=()=>{f.forEach((c)=>{if(g||m>=b||e[c])return;let f;const h=a[c];if(j(h)){let a=h.length-1;for(let b=0;b<a;b++)if(!k.call(d,h[b]))return;f=h[a]}else f=h;e[c]=!0,m++,Z((a)=>f(a,d),(a,...b)=>{l--,m--,g||(g=a||0===l,a?o(a,d):(d[c]=b.length?1===b.length?b[0]:b:null,g?o(a,d):p()))})})};p()},whilst:(a,b,c=W)=>{N(B(a),b,!1,!0,c)},doWhilst:(a,b,c=W)=>{N(B(b),a,!1,!1,c)},during:(a,b,c=W)=>{N(a,b,!1,!0,c)},doDuring:(a,b,c=W)=>{N(b,a,!1,!1,c)},until:(a,b,c=W)=>{N(B(a),b,!0,!0,c)},doUntil:(a,b,c=W)=>{N(B(b),a,!0,!1,c)},forever:(a,b=W)=>{const c=D(b),d=X(a),e=()=>{d(_(c,e))};e()},reduce:aa,inject:aa,foldl:aa,reduceRight:ba,foldr:ba,queue:(a,b)=>new S(a,b),priorityQueue:(a,b)=>new R(a,b),cargo:(a,b)=>new T(a,b),retry:ra,retryable:ra,times:(a,b,c)=>{K(a,i,b,c)},timesLimit:(a,b,c,d)=>{K(a,b,c,d)},timesSeries:(a,b,c)=>{K(a,1,b,c)},detect:(a,b,c)=>{L(a,i,b,c)},detectLimit:(a,b,c,d)=>{L(a,b,c,d)},detectSeries:(a,b,c)=>{L(a,1,b,c)},some:la,any:la,someLimit:ma,anyLimit:ma,someSeries:na,anySeries:na,every:oa,all:oa,everyLimit:pa,allLimit:pa,everySeries:qa,allSeries:qa,applyEach:ta,applyEachSeries:ua,asyncify:Y,wrapSync:Y,memoize:(a,b=(a)=>a)=>{const c={},d={},e=(...e)=>{const f=e.pop(),g=b(...e);k.call(c,g)?U(()=>f(...c[g])):k.call(d,g)?d[g].push(f):(d[g]=[f],a(...e,(...a)=>{c[g]=a;const b=d[g];delete d[g],b.forEach((b)=>{b(...a)})}))};return e.memo=c,e.unmemoized=a,e},unmemoize:(a)=>(...b)=>(a.unmemoized||a)(...b),transform:function(a,b,c,d){3>=arguments.length&&(d=c,c=b,b=j(a)?[]:{}),d=C(d),z(a,i,(a,d,e)=>{Z((e)=>c(b,a,d,e),e)},(a)=>d(a,b))},reflect:sa,reflectAll:(a)=>{if(j(a))return a.map(sa);let b={};return h(a).forEach((c)=>{b[c]=sa(a[c])}),b},race:(a,b)=>{if(!j(a))return t(m[0],b);if(!a.length)b();else{const c=C(b);a.forEach((a)=>{a(c)})}},tryEach:(a,b=W)=>{if(!n(a,b))return t(m[0],b);let c,d=null;z(a,1,(a,b,e)=>{Z(a,(a,...b)=>{c=1>=b.length?b[0]:b,d=a,e(!a)})},()=>{b(d,c)})}},Object.keys(a["default"]).forEach((b)=>{a[b]=a["default"][b]}),Object.defineProperty(a,"__esModule",{value:!0})});
